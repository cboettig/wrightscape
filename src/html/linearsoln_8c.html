<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>linearsoln.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>linearsoln.c File Reference</h1><code>#include &quot;tree.h&quot;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="linearsoln_8c.html#72563a25bf023e3c976c2a8ab861a5c3">sep_time</a> (int i, int j, tree *mytree)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="linearsoln_8c.html#387c8e2634f15e3d68e4b4371f28e78a">ou_likelihood</a> (tree *mytree)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ad3bc1a98d03589221bd0be337d8a074"></a><!-- doxytag: member="linearsoln.c::bm_likelihood" ref="ad3bc1a98d03589221bd0be337d8a074" args="(tree *mytree)" -->
double&nbsp;</td><td class="memItemRight" valign="bottom"><b>bm_likelihood</b> (tree *mytree)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="linearsoln_8c.html#3041e81cc6c05acd43545a9a59ccb16d">bm_ancestral_likelihood</a> (tree *mytree)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Carl Boettiger, &lt;<a href="mailto:cboettig@gmail.com">cboettig@gmail.com</a>&gt; </dd></dl>
<h2><a class="anchor" name="DESCRIPTION">
DESCRIPTION</a></h2>
Note: Comments formatted for Doxygen, which generates the documentation files.<p>
The likelihood function under a linear model is a multivariate normal. In the case of Brownian Motion, it is<p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ L(\mu, \sigma^2) \propto \frac{1}{\sigma^{2N}} \exp\left( \frac{-Q(\vec \mu)}{2\sigma^2}\right) \]" src="form_13.png">
<p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Q(\vec \mu ) = \sum_{i,j} \frac{(\mu_i - mu_j)^2}{\nu_{ij} } \]" src="form_2.png">
<p>
<p>
Where <img class="formulaInl" alt="$\vec \mu = \{ \mu_1 \ldots \mu_N\} $" src="form_3.png"> are the traits at the nodes and <img class="formulaInl" alt="$\nu_{ij} $" src="form_4.png"> the distances between them. <hr><h2>Function Documentation</h2>
<a class="anchor" name="3041e81cc6c05acd43545a9a59ccb16d"></a><!-- doxytag: member="linearsoln.c::bm_ancestral_likelihood" ref="3041e81cc6c05acd43545a9a59ccb16d" args="(tree *mytree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double bm_ancestral_likelihood           </td>
          <td>(</td>
          <td class="paramtype">tree *&nbsp;</td>
          <td class="paramname"> <em>mytree</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Likelihood under BM of an ancestral state configuration (all internal as well as tip nodes) 
</div>
</div><p>
<a class="anchor" name="387c8e2634f15e3d68e4b4371f28e78a"></a><!-- doxytag: member="linearsoln.c::ou_likelihood" ref="387c8e2634f15e3d68e4b4371f28e78a" args="(tree *mytree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ou_likelihood           </td>
          <td>(</td>
          <td class="paramtype">tree *&nbsp;</td>
          <td class="paramname"> <em>mytree</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The likelihood of a model under the OU process, <p class="formulaDsp">
<img class="formulaDsp" alt="\[ dX_t = \alpha (\theta - X_t) \d t + \sigma \d W_t \]" src="form_5.png">
<p>
 is multivariate normal. If only the n tips are specified (not computing likelihood of ancestral state) then this is determined by the n mean values and the n x n covariance matrix. The expected value at any node is determined only by the age of the node and the intitial condition of the root node (<img class="formulaInl" alt="$ X_0 $" src="form_6.png">): <p class="formulaDsp">
<img class="formulaDsp" alt="\[ E(X_t | X_0 ) = X_0 e^{-\alpha t} + \theta (1- e^{-\alpha t}) \]" src="form_7.png">
<p>
 The i,j element of the covariance matrix is <p class="formulaDsp">
<img class="formulaDsp" alt="\[ V_{ij} = \frac{\sigma^2}{2\alpha} (1 - e^{-2 \alpha s_{ij} }) e^{-2\alpha (t-s_{ij} )} \]" src="form_14.png">
<p>
 where the nodes are all measured at time t (present day) and have diverged for a time <img class="formulaInl" alt="$ t-s_{ij} $" src="form_17.png"> (thus shared time <img class="formulaInl" alt="$ s_{ij} $" src="form_18.png"> since <img class="formulaInl" alt="$ X_0 $" src="form_6.png">.<p>
As this is multivariate normal, the the log-likelihood is then <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \log L = (X - E(X) )^T V^{-1} (X-E(X) ) + N\log(2\pi \det V) \]" src="form_9.png">
<p>
 
<p>
<img class="formulaInl" alt="$ E(X_t | X_0 ) = X_0 e^{-\alpha t} + \theta (1- e^{-\alpha t}) $" src="form_10.png"> 
</div>
</div><p>
<a class="anchor" name="72563a25bf023e3c976c2a8ab861a5c3"></a><!-- doxytag: member="linearsoln.c::sep_time" ref="72563a25bf023e3c976c2a8ab861a5c3" args="(int i, int j, tree *mytree)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sep_time           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">tree *&nbsp;</td>
          <td class="paramname"> <em>mytree</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The branch length between nodes i and j; (twice their divergence time; down to common ancestor and back). Currently this requires i &amp; j to be the same age (i.e. both are tips in an ultrametric tree). The code opens with a warning message to handle this.<p>
This should really implement a clever and general algorithm. See the wikipedia page on Least Common Ancestor or the tutorial <dl class="see" compact><dt><b>See also:</b></dt><dd>{<a href="http://www.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor">http://www.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=lowestCommonAncestor</a>} </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Jan 27 16:39:29 2010 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
